extends ./MainTemplate.jade

block title
  title Serveurs

block content
  div(class='container-fluid')
      div(ng-controller='servercontroller')    

        //- Desktop buttons 
        div(class='actions hidden-xs hidden-sm')
            button(class="button-primary", ng-click='currentServer=""', ng-show='currentUser==undefined') Nouveau serveur

         //- Mobile buttons 
        div(class='actions hidden-lg hidden-md')
            button(class="button-secondary" ng-click='back()') Retour
            button(class="button-primary", ng-click='currentServer=""', ng-show='currentUser==undefined') Ajouter

        div(class="table servertable hidden-xs hidden-sm")
            div(class='table')
                table
                    thead
                        tr
                            th Adresse
                            th Port
                            th Login
                            th Description
                            th 
                            th
                    tr(ng-repeat='x in servers')          
                        td 
                            input(type="text" value="{{ x.address }}")
                        td 
                            input(type="text" value="{{ x.port }}")
                        td 
                            input(type="text" value="{{ x.username }}")     
                        td 
                            input(type="text" value="{{ x.description }}")
                        td
                            span(class='glyphicon glyphicon-ok', ng-show='x.connected', title='Connected')
                            span(class='glyphicon glyphicon-alert', ng-show='!x.connected', title='Disconnected')
                        td 
                            button(ng-click='deleteServer(x.id)', title='Delete server',  class="button-primary") Supprimer


        div(class="userlist hidden-md hidden-lg" id="serverlist")
            div(ng-repeat='x in servers', class='panel accordion-item')
                h5 
                    a(href='#collapse{{$index}}', data-toggle='collapse',
                        class="drop", data-parent='#serverlist') {{ x.description }}
                div(id='collapse{{ $index }}', class='collapse')
                    form
                        .form-group
                            label(for="address") Adresse
                            input(type="text", class="form-control",
                              id="address", value="{{ x.address }}")
                        .form-group
                            label(for="port") Port
                            input(type="text", class="form-control",
                              id="port", value="{{ x.port }}")
                        .form-group
                            label(for="username") Login
                            input(type="text", class="form-control",
                              id="username", value="{{ x.username }}")
                        .form-group
                            label(for="description") Description
                            input(type="text", class="form-control",
                              id="description", value="{{ x.description }}")
                      .form-group
                        button(ng-click='deleteUser(x.id)', title='Delete user',  class="button-primary full-width") Supprimer le serveur



        div(id='newserver', ng-show='currentServer!=undefined', class="form-input")
            .form-group
                label(for='id') Server address
                input(type='text', id='login' placeholder='Adress', ng-model='currentServer.address', class="form-control")
            .form-group
                label(for='port') Server port
                input(type='text', id='port' placeholder='Port', ng-model='currentServer.port', class="form-control")
            .form-group
                label(for='user') Login
                input(type='text', id='user' placeholder='Username', ng-model='currentServer.username', class="form-control")
            .form-group
                label(for='password') Password
                input(type='text', id='password' placeholder='Password', ng-model='currentServer.password', class="form-control")
            .form-group
                label(for='description') Server description
                input(type='text', id='description' placeholder='Description', ng-model='currentServer.description', class="form-control")

            button(ng-click='commitCurrentServer()' class="btn btn-sm btn-primary btn-block") OK
            button(ng-click='currentServer=undefined;serverMsg=undefined',  class="btn btn-sm btn-default btn-block") Cancel
        
        div(class='alert alert-warning space-before', ng-show='serverMsg!=undefined') {{ serverMsg  }}


  script(src='static/EventSource4IE.js')  
  script(src='static/EventSource.js')  
  script(src='static/serverviewer.js')  